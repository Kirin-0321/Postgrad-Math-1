# 一元函数微分学

## 导数的概念

### 导数的定义

设函数 $y=f(x)$ 在点 $x_0$ 的某邻域内有定义，如果极限
$$\lim\limits_{\Delta x \to 0}\frac{f(x_0+\Delta x)-f(x_0)}{\Delta x}$$
存在，则称函数 $f(x)$ 在点 $x_0$ 处可导，并称此极限值为函数 $f(x)$ 在点 $x_0$ 处的导数，记作 $f'(x_0)$ 或 $\frac{dy}{dx}|_{x=x_0}$。

### 导数的几何意义

函数 $f(x)$ 在点 $x_0$ 处的导数 $f'(x_0)$ 表示曲线 $y=f(x)$ 在点 $(x_0,f(x_0))$ 处的切线斜率。
切线方程：$y-f(x_0)=f'(x_0)(x-x_0)$
法线方程：$y-f(x_0)=-\frac{1}{f'(x_0)}(x-x_0)$ (当 $f'(x_0) \neq 0$ 时)

### 可导与连续的关系

如果函数 $f(x)$ 在点 $x_0$ 处可导，则函数 $f(x)$ 在点 $x_0$ 处必定连续。
反之，若函数在某点连续，则该函数在该点不一定可导。

## 基本初等函数的导数

1. $(C)' = 0$（常数的导数为零）
2. $(x^n)' = nx^{n-1}$
3. $(\sin x)' = \cos x$
4. $(\cos x)' = -\sin x$
5. $(\tan x)' = \sec^2 x$
6. $(\cot x)' = -\csc^2 x$
7. $(\sec x)' = \sec x \tan x$
8. $(\csc x)' = -\csc x \cot x$
9. $(a^x)' = a^x \ln a$（特别地，$(e^x)' = e^x$）
10. $(\log_a x)' = \frac{1}{x \ln a}$（特别地，$(\ln x)' = \frac{1}{x}$）
11. $(\arcsin x)' = \frac{1}{\sqrt{1-x^2}}$
12. $(\arccos x)' = -\frac{1}{\sqrt{1-x^2}}$
13. $(\arctan x)' = \frac{1}{1+x^2}$
14. $(\text{arccot}\ x)' = -\frac{1}{1+x^2}$

## 求导法则

### 函数的和、差、积、商的求导法则

1. $(u \pm v)' = u' \pm v'$
2. $(uv)' = u'v + uv'$
3. $\left(\frac{u}{v}\right)' = \frac{u'v - uv'}{v^2}$ (当 $v \neq 0$)

### 复合函数的求导法则

若 $y=f(u)$，$u=g(x)$，且 $f(u)$ 在 $u$ 处可导，$g(x)$ 在 $x$ 处可导，则复合函数 $y=f[g(x)]$ 在 $x$ 处可导，且
$$\frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dx} = f'(u) \cdot g'(x)$$

### 反函数的求导法则

若函数 $y=f(x)$ 在区间 $I$ 上严格单调且可导，且 $f'(x) \neq 0$，则其反函数 $x=f^{-1}(y)$ 在对应区间上也可导，且
$$\frac{dx}{dy} = \frac{1}{\frac{dy}{dx}}$$
即 $(f^{-1})'(y) = \frac{1}{f'(x)}$，其中 $y=f(x)$。

### 隐函数的求导法则

若方程 $F(x, y) = 0$ 确定了 $y$ 关于 $x$ 的函数 $y=f(x)$，且 $\frac{\partial F}{\partial y} \neq 0$，则
$$\frac{dy}{dx} = -\frac{\frac{\partial F}{\partial x}}{\frac{\partial F}{\partial y}}$$

### 参数方程的求导法则

若函数 $x=\varphi(t)$，$y=\psi(t)$ 都可导，且 $\varphi'(t) \neq 0$，则
$$\frac{dy}{dx} = \frac{\frac{dy}{dt}}{\frac{dx}{dt}} = \frac{\psi'(t)}{\varphi'(t)}$$

### 对数求导法

对于形如 $y=u^v$，或者包含多个因子乘积、幂或商的复杂表达式，可以通过取对数然后求导：
$$\ln y = \ln u^v = v \ln u$$
两边对 $x$ 求导得：
$$\frac{1}{y} \cdot \frac{dy}{dx} = v \cdot \frac{u'}{u} + (\ln u) \cdot v'$$
进而得到 $\frac{dy}{dx}$。

## 高阶导数

### 高阶导数的定义

函数 $y=f(x)$ 的 $n$ 阶导数记为 $f^{(n)}(x)$ 或 $\frac{d^n y}{dx^n}$。

### 常见函数的高阶导数

1. $(x^m)^{(n)} = m(m-1)(m-2)...(m-n+1)x^{m-n}$，当 $m$ 为正整数且 $n > m$ 时，$(x^m)^{(n)} = 0$
2. $(\sin x)^{(n)} = \sin(x + \frac{n\pi}{2})$
3. $(\cos x)^{(n)} = \cos(x + \frac{n\pi}{2})$
4. $(e^x)^{(n)} = e^x$
5. $(a^x)^{(n)} = a^x (\ln a)^n$
6. $(\ln x)^{(n)} = (-1)^{n-1}\frac{(n-1)!}{x^n}$

### 莱布尼茨公式

$(uv)^{(n)} = \sum_{k=0}^{n} C_n^k u^{(k)} v^{(n-k)}$

## 微分中值定理

### 罗尔定理

如果函数 $f(x)$ 满足：

1. 在闭区间 $[a,b]$ 上连续
2. 在开区间 $(a,b)$ 内可导
3. $f(a) = f(b)$

则至少存在一点 $\xi \in (a,b)$，使得 $f'(\xi) = 0$。

### 拉格朗日中值定理

如果函数 $f(x)$ 满足：

1. 在闭区间 $[a,b]$ 上连续
2. 在开区间 $(a,b)$ 内可导

则至少存在一点 $\xi \in (a,b)$，使得
$$f'(\xi) = \frac{f(b) - f(a)}{b - a}$$

### 柯西中值定理

如果函数 $f(x)$ 和 $g(x)$ 满足：

1. 在闭区间 $[a,b]$ 上连续
2. 在开区间 $(a,b)$ 内可导
3. 对任一 $x \in (a,b)$，$g'(x) \neq 0$

则至少存在一点 $\xi \in (a,b)$，使得
$$\frac{f'(\xi)}{g'(\xi)} = \frac{f(b) - f(a)}{g(b) - g(a)}$$

## 洛必达法则

### 洛必达法则的条件与结论

如果函数 $f(x)$ 和 $g(x)$ 满足：

1. 当 $x \to a$ 时，$\lim f(x) = \lim g(x) = 0$ 或 $\lim f(x) = \lim g(x) = \infty$
2. 在点 $a$ 的某去心邻域内，$f(x)$ 和 $g(x)$ 可导且 $g'(x) \neq 0$
3. $\lim\limits_{x \to a}\frac{f'(x)}{g'(x)}$ 存在或为无穷大

则
$$\lim\limits_{x \to a}\frac{f(x)}{g(x)} = \lim\limits_{x \to a}\frac{f'(x)}{g'(x)}$$

### 注意事项

1. 洛必达法则适用于 $\frac{0}{0}$ 和 $\frac{\infty}{\infty}$ 型的未定式
2. 对于其他类型的未定式，如 $0 \cdot \infty$、$\infty - \infty$、$0^0$、$\infty^0$、$1^{\infty}$ 等，可先转化为 $\frac{0}{0}$ 或 $\frac{\infty}{\infty}$ 型，再使用洛必达法则
3. 如果使用一次洛必达法则后还是未定式，可以继续使用

## 泰勒公式

### 泰勒公式的定义

若函数 $f(x)$ 在点 $x_0$ 处的导数直到 $n$ 阶都存在，则
$$f(x) = f(x_0) + f'(x_0)(x-x_0) + \frac{f''(x_0)}{2!}(x-x_0)^2 + \ldots + \frac{f^{(n)}(x_0)}{n!}(x-x_0)^n + R_n(x)$$

其中 $R_n(x)$ 为余项，常用的余项形式有：

#### 拉格朗日余项

$$R_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1}$$
其中 $\xi$ 介于 $x_0$ 和 $x$ 之间。

#### 佩亚诺余项

$$R_n(x) = o((x-x_0)^n)$$

### 麦克劳林公式

泰勒公式在 $x_0 = 0$ 时的特殊情况称为麦克劳林公式：
$$f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \ldots + \frac{f^{(n)}(0)}{n!}x^n + R_n(x)$$

### 常见函数的麦克劳林展开式

1. $e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \ldots + \frac{x^n}{n!} + \frac{e^{\xi}}{(n+1)!}x^{n+1}$

2. $\sin x = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \ldots + (-1)^m\frac{x^{2m+1}}{(2m+1)!} + R_{2m+1}(x)$

3. $\cos x = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \ldots + (-1)^m\frac{x^{2m}}{(2m)!} + R_{2m}(x)$

4. $\ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3} - \ldots + (-1)^{n-1}\frac{x^n}{n} + R_n(x)$，$|x| < 1$

5. $(1+x)^{\alpha} = 1 + \alpha x + \frac{\alpha(\alpha-1)}{2!}x^2 + \ldots + \frac{\alpha(\alpha-1)\ldots(\alpha-n+1)}{n!}x^n + R_n(x)$，$|x| < 1$

## 函数的单调性与极值

### 函数单调性的判定

若 $f'(x) > 0$ 在区间 $I$ 上恒成立，则函数 $f(x)$ 在区间 $I$ 上严格单调增加；
若 $f'(x) < 0$ 在区间 $I$ 上恒成立，则函数 $f(x)$ 在区间 $I$ 上严格单调减少。

### 函数极值的必要条件

若函数 $f(x)$ 在点 $x_0$ 处可导且取得极值，则 $f'(x_0) = 0$。

### 函数极值的第一充分条件

若函数 $f(x)$ 在点 $x_0$ 处连续，在 $x_0$ 的去心邻域内可导，且

1. 当 $x < x_0$ 时，$f'(x) > 0$；当 $x > x_0$ 时，$f'(x) < 0$，则 $f(x)$ 在点 $x_0$ 处取得极大值
2. 当 $x < x_0$ 时，$f'(x) < 0$；当 $x > x_0$ 时，$f'(x) > 0$，则 $f(x)$ 在点 $x_0$ 处取得极小值

### 函数极值的第二充分条件

若函数 $f(x)$ 在点 $x_0$ 的某邻域内二阶可导，且 $f'(x_0) = 0$：

1. 若 $f''(x_0) < 0$，则 $f(x)$ 在点 $x_0$ 处取得极大值
2. 若 $f''(x_0) > 0$，则 $f(x)$ 在点 $x_0$ 处取得极小值
3. 若 $f''(x_0) = 0$，则需要进一步判断

### 函数极值的高阶导数判别法

若函数 $f(x)$ 在点 $x_0$ 处 $n$ 阶可导，且 $f'(x_0) = f''(x_0) = \ldots = f^{(n-1)}(x_0) = 0$，$f^{(n)}(x_0) \neq 0$：

1. 若 $n$ 为奇数，则 $f(x)$ 在点 $x_0$ 处不取极值
2. 若 $n$ 为偶数，当 $f^{(n)}(x_0) < 0$ 时，$f(x)$ 在点 $x_0$ 处取得极大值；当 $f^{(n)}(x_0) > 0$ 时，$f(x)$ 在点 $x_0$ 处取得极小值

## 函数的凹凸性与拐点

### 函数凹凸性的判定

若函数 $f(x)$ 在区间 $I$ 上二阶可导：

1. 当 $f''(x) > 0$ 时，函数 $f(x)$ 在区间 $I$ 上为凹函数（图像向上凸）
2. 当 $f''(x) < 0$ 时，函数 $f(x)$ 在区间 $I$ 上为凸函数（图像向下凸）

### 拐点的判定

若函数 $f(x)$ 在点 $x_0$ 处连续，且在 $x_0$ 的两侧具有不同的凹凸性，则点 $(x_0, f(x_0))$ 为函数图像的拐点。

若函数 $f(x)$ 在包含 $x_0$ 的区间上二阶可导，且 $f''(x_0) = 0$，$f'''(x_0) \neq 0$，则点 $(x_0, f(x_0))$ 为函数图像的拐点。

## 曲线的渐近线

### 水平渐近线

若 $\lim\limits_{x \to +\infty} f(x) = b$ 或 $\lim\limits_{x \to -\infty} f(x) = b$，则直线 $y = b$ 为曲线 $y = f(x)$ 的水平渐近线。

### 铅直渐近线

若 $\lim\limits_{x \to x_0} f(x) = \infty$，则直线 $x = x_0$ 为曲线 $y = f(x)$ 的铅直渐近线。

### 斜渐近线

若 $\lim\limits_{x \to \infty} \frac{f(x)}{x} = a \neq 0$ 且 $\lim\limits_{x \to \infty} [f(x) - ax] = b$，则直线 $y = ax + b$ 为曲线 $y = f(x)$ 的斜渐近线。